!function($){"use strict";var e={initialize:function(){var e=this;$(".erp-hr-leave-policy").on("click","a#erp-leave-policy-new",e,this.policy.create),$(".erp-hr-leave-policy").on("click","a.link, span.edit a",e,this.policy.edit),$(".erp-hr-leave-policy").on("click","a.submitdelete",e,this.policy.remove),$(".erp-hr-leave-request-new").on("change",".erp-date-field",e,this.leave.requestDates),$(".erp-employee-single").on("submit","form#erp-hr-empl-leave-history",this.leave.showHistory)},policy:{submit:function(e){wp.ajax.send({data:this.serializeObject(),success:function(){e.closeModal(),$(".list-table-wrap").load(window.location.href+" .list-wrap-inner")},error:function(t){e.enableButton(),alert(t)}})},create:function(e){$.erpPopup({title:wpErpHr.popup.policy,button:wpErpHr.popup.policy_create,content:wp.template("erp-leave-policy")({data:null}),extraClass:"smaller",onReady:function(){$(".erp-color-picker").wpColorPicker()},onSubmit:function(t){e.data.policy.submit.call(this,t)}})},edit:function(e){e.preventDefault();var t=$(this),r=t.closest("tr").data("json");$.erpPopup({title:wpErpHr.popup.policy,button:wpErpHr.popup.update_status,content:wp.template("erp-leave-policy")(r),extraClass:"smaller",onReady:function(){$(".erp-color-picker").wpColorPicker()},onSubmit:function(t){e.data.policy.submit.call(this,t)}})},remove:function(e){e.preventDefault();var t=$(this);confirm(wpErpHr.delConfirmEmployee)&&wp.ajax.send("erp-hr-leave-policy-delete",{data:{_wpnonce:wpErpHr.nonce,id:t.data("id")},success:function(){t.closest("tr").fadeOut("fast",function(){$(this).remove()})},error:function(e){alert(e)}})}},leave:{requestDates:function(){var e=$("#leave_from").val(),t=$("#leave_to").val(),r=$(this).closest("form").find("input[type=submit]"),a=parseInt($("#employee_id").val());""!==e&&""!==t&&wp.ajax.send("erp-hr-leave-request-req-date",{data:{_wpnonce:wpErpHr.nonce,from:e,to:t,employee_id:a},success:function(e){var t=wp.template("erp-leave-days")(e);$("li.show-days").html(t),r.removeAttr("disabled")},error:function(e){$("li.show-days").empty(),r.attr("disabled","disable"),alert(e)}})},showHistory:function(e){e.preventDefault();var t=$(this);wp.ajax.send("erp-hr-empl-leave-history",{data:t.serializeObject(),success:function(e){$("table#erp-hr-empl-leave-history tbody").html(e)}})}}};$(function(){e.initialize()})}(jQuery);